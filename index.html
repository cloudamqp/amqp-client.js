<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@cloudamqp/amqp-client</title><meta name="description" content="Documentation for @cloudamqp/amqp-client"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">@cloudamqp/amqp-client</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@cloudamqp/amqp-client</h1></div><div class="tsd-panel tsd-typography"><h1 id="amqp-clientjs" class="tsd-anchor-link">amqp-client.js<a href="#amqp-clientjs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>AMQP 0-9-1 TypeScript client both for Node.js and browsers (using WebSocket). This library is intended to replace all other Node.js AMQP libraries.</p>
<p><a href="https://cloudamqp.github.io/amqp-client.js/">API documentation</a>.</p>
<p>This library is Promise-based and hence works very well with async/await. It's secure by default, for instance, publishes aren't fulfilled until either the data has been sent on the wire (so that back propagation is respected), or if the channel has Publish Confirms enabled, it isn't fulfilled until the server has acknowledged that the message has been enqueued.</p>
<p>The library was developed so to make it easy for developers who already are familiar with AMQP to write browser apps that communicates directly with an AMQP server over WebSocket.</p>
<h2 id="support" class="tsd-anchor-link">Support<a href="#support" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The library is developed and supported by <a href="https://www.cloudamqp.com">CloudAMQP</a>, the largest hosted RabbitMQ provider in the world.</p>
<h2 id="install" class="tsd-anchor-link">Install<a href="#install" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="shell"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@cloudamqp/amqp-client</span><span class="hl-1"> </span><span class="hl-3">--save</span>
</code><button type="button">Copy</button></pre>

<p>Start node with <code>--enable-source-maps</code> to get proper stacktraces as the library is transpiled from TypeScript.</p>
<h2 id="example-usage" class="tsd-anchor-link">Example usage<a href="#example-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Using AMQP in Node.js:</p>
<pre><code class="javascript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AMQPClient</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@cloudamqp/amqp-client&quot;</span><br/><br/><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">amqp</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AMQPClient</span><span class="hl-1">(</span><span class="hl-2">&quot;amqp://localhost&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">conn</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">amqp</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">ch</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">conn</span><span class="hl-1">.</span><span class="hl-0">channel</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">q</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">ch</span><span class="hl-1">.</span><span class="hl-0">queue</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">consumer</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">q</span><span class="hl-1">.</span><span class="hl-0">subscribe</span><span class="hl-1">({ </span><span class="hl-5">noAck:</span><span class="hl-1"> </span><span class="hl-3">true</span><span class="hl-1"> }, </span><span class="hl-3">async</span><span class="hl-1"> (</span><span class="hl-5">msg</span><span class="hl-1">) </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-5">msg</span><span class="hl-1">.</span><span class="hl-0">bodyToString</span><span class="hl-1">())</span><br/><span class="hl-1">      </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">consumer</span><span class="hl-1">.</span><span class="hl-0">cancel</span><span class="hl-1">()</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">    </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">q</span><span class="hl-1">.</span><span class="hl-0">publish</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World&quot;</span><span class="hl-1">, { </span><span class="hl-5">deliveryMode:</span><span class="hl-1"> </span><span class="hl-7">2</span><span class="hl-1"> })</span><br/><span class="hl-1">    </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">consumer</span><span class="hl-1">.</span><span class="hl-0">wait</span><span class="hl-1">() </span><span class="hl-8">// will block until consumer is canceled or throw an error if server closed channel/connection</span><br/><span class="hl-1">    </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">conn</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">()</span><br/><span class="hl-1">  } </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;ERROR&quot;</span><span class="hl-1">, </span><span class="hl-5">e</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-5">e</span><span class="hl-1">.</span><span class="hl-5">connection</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-0">setTimeout</span><span class="hl-1">(</span><span class="hl-5">run</span><span class="hl-1">, </span><span class="hl-7">1000</span><span class="hl-1">) </span><span class="hl-8">// will try to reconnect in 1s</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">run</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h2 id="websockets" class="tsd-anchor-link">WebSockets<a href="#websockets" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This library can be used in the browser to access an AMQP server over WebSockets. For servers such as RabbitMQ that doesn't (yet?) support WebSockets natively a <a href="https://github.com/cloudamqp/websocket-tcp-relay/">WebSocket TCP relay</a> have to be used as a proxy. More information can be found <a href="https://www.cloudamqp.com/blog/cloudamqp-releases-amqp-websockets.html">in this blog post</a>.</p>
<p>For web browsers a <a href="https://www.typescriptlang.org/">compiled</a> and <a href="https://www.rollupjs.org/">rolled up</a> version is available at <a href="https://github.com/cloudamqp/amqp-client.js/releases">https://github.com/cloudamqp/amqp-client.js/releases</a>.</p>
<p>Using AMQP over WebSockets in a browser:</p>
<pre><code class="html"><span class="hl-9">&lt;!</span><span class="hl-10">DOCTYPE</span><span class="hl-1"> </span><span class="hl-11">html</span><span class="hl-9">&gt;</span><br/><span class="hl-9">&lt;</span><span class="hl-10">html</span><span class="hl-9">&gt;</span><br/><span class="hl-1">  </span><span class="hl-9">&lt;</span><span class="hl-10">head</span><span class="hl-9">&gt;</span><br/><span class="hl-1">    </span><span class="hl-9">&lt;</span><span class="hl-10">script</span><span class="hl-12"> </span><span class="hl-11">type</span><span class="hl-12">=</span><span class="hl-13">&quot;module&quot;</span><span class="hl-9">&gt;</span><br/><span class="hl-12">      </span><span class="hl-4">import</span><span class="hl-12"> { </span><span class="hl-5">AMQPWebSocketClient</span><span class="hl-12"> } </span><span class="hl-4">from</span><span class="hl-12"> </span><span class="hl-2">&quot;./js/amqp-websocket-client.mjs&quot;</span><br/><br/><span class="hl-12">      </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">textarea</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-5">document</span><span class="hl-12">.</span><span class="hl-0">getElementById</span><span class="hl-12">(</span><span class="hl-2">&quot;textarea&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">      </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">input</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-5">document</span><span class="hl-12">.</span><span class="hl-0">getElementById</span><span class="hl-12">(</span><span class="hl-2">&quot;message&quot;</span><span class="hl-12">)</span><br/><br/><span class="hl-12">      </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">tls</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-5">window</span><span class="hl-12">.</span><span class="hl-5">location</span><span class="hl-12">.</span><span class="hl-5">protocol</span><span class="hl-12"> </span><span class="hl-1">===</span><span class="hl-12"> </span><span class="hl-2">&quot;https:&quot;</span><br/><span class="hl-12">      </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">url</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-2">`</span><span class="hl-3">${</span><span class="hl-5">tls</span><span class="hl-12"> </span><span class="hl-1">?</span><span class="hl-12"> </span><span class="hl-2">&quot;wss&quot;</span><span class="hl-12"> </span><span class="hl-1">:</span><span class="hl-12"> </span><span class="hl-2">&quot;ws&quot;</span><span class="hl-3">}</span><span class="hl-2">://</span><span class="hl-3">${</span><span class="hl-5">window</span><span class="hl-12">.</span><span class="hl-5">location</span><span class="hl-12">.</span><span class="hl-5">host</span><span class="hl-3">}</span><span class="hl-2">`</span><br/><span class="hl-12">      </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">amqp</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-3">new</span><span class="hl-12"> </span><span class="hl-0">AMQPWebSocketClient</span><span class="hl-12">(</span><span class="hl-5">url</span><span class="hl-12">, </span><span class="hl-2">&quot;/&quot;</span><span class="hl-12">, </span><span class="hl-2">&quot;guest&quot;</span><span class="hl-12">, </span><span class="hl-2">&quot;guest&quot;</span><span class="hl-12">)</span><br/><br/><span class="hl-12">      </span><span class="hl-3">async</span><span class="hl-12"> </span><span class="hl-3">function</span><span class="hl-12"> </span><span class="hl-0">start</span><span class="hl-12">() {</span><br/><span class="hl-12">        </span><span class="hl-4">try</span><span class="hl-12"> {</span><br/><span class="hl-12">          </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">conn</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">amqp</span><span class="hl-12">.</span><span class="hl-0">connect</span><span class="hl-12">()</span><br/><span class="hl-12">          </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">ch</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">conn</span><span class="hl-12">.</span><span class="hl-0">channel</span><span class="hl-12">()</span><br/><span class="hl-12">          </span><span class="hl-0">attachPublish</span><span class="hl-12">(</span><span class="hl-5">ch</span><span class="hl-12">)</span><br/><span class="hl-12">          </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">q</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">ch</span><span class="hl-12">.</span><span class="hl-0">queue</span><span class="hl-12">(</span><span class="hl-2">&quot;&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">          </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">q</span><span class="hl-12">.</span><span class="hl-0">bind</span><span class="hl-12">(</span><span class="hl-2">&quot;amq.fanout&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">          </span><span class="hl-3">const</span><span class="hl-12"> </span><span class="hl-6">consumer</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">q</span><span class="hl-12">.</span><span class="hl-0">subscribe</span><span class="hl-12">({ </span><span class="hl-5">noAck:</span><span class="hl-12"> </span><span class="hl-3">false</span><span class="hl-12"> }, (</span><span class="hl-5">msg</span><span class="hl-12">) </span><span class="hl-3">=&gt;</span><span class="hl-12"> {</span><br/><span class="hl-12">            </span><span class="hl-5">console</span><span class="hl-12">.</span><span class="hl-0">log</span><span class="hl-12">(</span><span class="hl-5">msg</span><span class="hl-12">)</span><br/><span class="hl-12">            </span><span class="hl-5">textarea</span><span class="hl-12">.</span><span class="hl-5">value</span><span class="hl-12"> </span><span class="hl-1">+=</span><span class="hl-12"> </span><span class="hl-5">msg</span><span class="hl-12">.</span><span class="hl-0">bodyToString</span><span class="hl-12">() </span><span class="hl-1">+</span><span class="hl-12"> </span><span class="hl-2">&quot;</span><span class="hl-14">\n</span><span class="hl-2">&quot;</span><br/><span class="hl-12">            </span><span class="hl-5">msg</span><span class="hl-12">.</span><span class="hl-0">ack</span><span class="hl-12">()</span><br/><span class="hl-12">          })</span><br/><span class="hl-12">        } </span><span class="hl-4">catch</span><span class="hl-12"> (</span><span class="hl-5">err</span><span class="hl-12">) {</span><br/><span class="hl-12">          </span><span class="hl-5">console</span><span class="hl-12">.</span><span class="hl-0">error</span><span class="hl-12">(</span><span class="hl-2">&quot;Error&quot;</span><span class="hl-12">, </span><span class="hl-5">err</span><span class="hl-12">, </span><span class="hl-2">&quot;reconnecting in 1s&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">          </span><span class="hl-0">disablePublish</span><span class="hl-12">()</span><br/><span class="hl-12">          </span><span class="hl-0">setTimeout</span><span class="hl-12">(</span><span class="hl-5">start</span><span class="hl-12">, </span><span class="hl-7">1000</span><span class="hl-12">)</span><br/><span class="hl-12">        }</span><br/><span class="hl-12">      }</span><br/><br/><span class="hl-12">      </span><span class="hl-3">function</span><span class="hl-12"> </span><span class="hl-0">attachPublish</span><span class="hl-12">(</span><span class="hl-5">ch</span><span class="hl-12">) {</span><br/><span class="hl-12">        </span><span class="hl-5">document</span><span class="hl-12">.</span><span class="hl-5">forms</span><span class="hl-12">[</span><span class="hl-7">0</span><span class="hl-12">].</span><span class="hl-0">onsubmit</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-3">async</span><span class="hl-12"> (</span><span class="hl-5">e</span><span class="hl-12">) </span><span class="hl-3">=&gt;</span><span class="hl-12"> {</span><br/><span class="hl-12">          </span><span class="hl-5">e</span><span class="hl-12">.</span><span class="hl-0">preventDefault</span><span class="hl-12">()</span><br/><span class="hl-12">          </span><span class="hl-4">try</span><span class="hl-12"> {</span><br/><span class="hl-12">            </span><span class="hl-4">await</span><span class="hl-12"> </span><span class="hl-5">ch</span><span class="hl-12">.</span><span class="hl-0">basicPublish</span><span class="hl-12">(</span><span class="hl-2">&quot;amq.fanout&quot;</span><span class="hl-12">, </span><span class="hl-2">&quot;&quot;</span><span class="hl-12">, </span><span class="hl-5">input</span><span class="hl-12">.</span><span class="hl-5">value</span><span class="hl-12">, {</span><br/><span class="hl-12">              </span><span class="hl-5">contentType:</span><span class="hl-12"> </span><span class="hl-2">&quot;text/plain&quot;</span><span class="hl-12">,</span><br/><span class="hl-12">            })</span><br/><span class="hl-12">          } </span><span class="hl-4">catch</span><span class="hl-12"> (</span><span class="hl-5">err</span><span class="hl-12">) {</span><br/><span class="hl-12">            </span><span class="hl-5">console</span><span class="hl-12">.</span><span class="hl-0">error</span><span class="hl-12">(</span><span class="hl-2">&quot;Error&quot;</span><span class="hl-12">, </span><span class="hl-5">err</span><span class="hl-12">, </span><span class="hl-2">&quot;reconnecting in 1s&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">            </span><span class="hl-0">disablePublish</span><span class="hl-12">()</span><br/><span class="hl-12">            </span><span class="hl-0">setTimeout</span><span class="hl-12">(</span><span class="hl-5">start</span><span class="hl-12">, </span><span class="hl-7">1000</span><span class="hl-12">)</span><br/><span class="hl-12">          }</span><br/><span class="hl-12">          </span><span class="hl-5">input</span><span class="hl-12">.</span><span class="hl-5">value</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-2">&quot;&quot;</span><br/><span class="hl-12">        }</span><br/><span class="hl-12">      }</span><br/><br/><span class="hl-12">      </span><span class="hl-3">function</span><span class="hl-12"> </span><span class="hl-0">disablePublish</span><span class="hl-12">() {</span><br/><span class="hl-12">        </span><span class="hl-5">document</span><span class="hl-12">.</span><span class="hl-5">forms</span><span class="hl-12">[</span><span class="hl-7">0</span><span class="hl-12">].</span><span class="hl-0">onsubmit</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> (</span><span class="hl-5">e</span><span class="hl-12">) </span><span class="hl-3">=&gt;</span><span class="hl-12"> {</span><br/><span class="hl-12">          </span><span class="hl-0">alert</span><span class="hl-12">(</span><span class="hl-2">&quot;Disconnected, waiting to be reconnected&quot;</span><span class="hl-12">)</span><br/><span class="hl-12">        }</span><br/><span class="hl-12">      }</span><br/><br/><span class="hl-12">      </span><span class="hl-0">start</span><span class="hl-12">()</span><br/><span class="hl-12">    </span><span class="hl-9">&lt;/</span><span class="hl-10">script</span><span class="hl-9">&gt;</span><br/><span class="hl-1">  </span><span class="hl-9">&lt;/</span><span class="hl-10">head</span><span class="hl-9">&gt;</span><br/><span class="hl-1">  </span><span class="hl-9">&lt;</span><span class="hl-10">body</span><span class="hl-9">&gt;</span><br/><span class="hl-1">    </span><span class="hl-9">&lt;</span><span class="hl-10">form</span><span class="hl-9">&gt;</span><br/><span class="hl-1">      </span><span class="hl-9">&lt;</span><span class="hl-10">textarea</span><span class="hl-1"> </span><span class="hl-11">id</span><span class="hl-1">=</span><span class="hl-13">&quot;textarea&quot;</span><span class="hl-1"> </span><span class="hl-11">rows</span><span class="hl-1">=</span><span class="hl-13">&quot;10&quot;</span><span class="hl-9">&gt;&lt;/</span><span class="hl-10">textarea</span><span class="hl-9">&gt;</span><br/><span class="hl-1">      </span><span class="hl-9">&lt;</span><span class="hl-10">br</span><span class="hl-1"> </span><span class="hl-9">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-9">&lt;</span><span class="hl-10">input</span><span class="hl-1"> </span><span class="hl-11">id</span><span class="hl-1">=</span><span class="hl-13">&quot;message&quot;</span><span class="hl-1"> </span><span class="hl-9">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-9">&lt;</span><span class="hl-10">button</span><span class="hl-1"> </span><span class="hl-11">type</span><span class="hl-1">=</span><span class="hl-13">&quot;submit&quot;</span><span class="hl-9">&gt;</span><span class="hl-1">Send</span><span class="hl-9">&lt;/</span><span class="hl-10">button</span><span class="hl-9">&gt;</span><br/><span class="hl-1">    </span><span class="hl-9">&lt;/</span><span class="hl-10">form</span><span class="hl-9">&gt;</span><br/><span class="hl-1">  </span><span class="hl-9">&lt;/</span><span class="hl-10">body</span><span class="hl-9">&gt;</span><br/><span class="hl-9">&lt;/</span><span class="hl-10">html</span><span class="hl-9">&gt;</span>
</code><button type="button">Copy</button></pre>

<h2 id="performance" class="tsd-anchor-link">Performance<a href="#performance" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Messages with a 1-byte body, no properties:</p>
<table>
<thead>
<tr>
<th>Client</th>
<th>Publish rate</th>
<th>Consume rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>amqp-client.js</td>
<td>300.000 msgs/s</td>
<td>512.000 msgs/s</td>
</tr>
<tr>
<td>amqplib</td>
<td>172.000 msgs/s</td>
<td>519.000 msgs/s</td>
</tr>
</tbody>
</table>
<p>Messages with a 1-byte body, and all properties, except headers:</p>
<table>
<thead>
<tr>
<th>Client</th>
<th>Publish rate</th>
<th>Consume rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>amqp-client.js</td>
<td>144.000 msgs/s</td>
<td>202.000 msgs/s</td>
</tr>
<tr>
<td>amqplib</td>
<td>110.000 msgs/s</td>
<td>251.000 msgs/s</td>
</tr>
</tbody>
</table>
<p>Messages with a 1-byte body, and all properties, including headers:</p>
<table>
<thead>
<tr>
<th>Client</th>
<th>Publish rate</th>
<th>Consume rate</th>
</tr>
</thead>
<tbody>
<tr>
<td>amqp-client.js</td>
<td>70.000 msgs/s</td>
<td>89.000 msgs/s</td>
</tr>
<tr>
<td>amqplib</td>
<td>60.000 msgs/s</td>
<td>99.000 msgs/s</td>
</tr>
</tbody>
</table>
<p>The reason amqp-client is somewhat slower to consume is that to maintain browser compatibility for the websocket client, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a> are used for parsing the binary protocol instead of <a href="https://nodejs.org/api/buffer.html"><code>Buffer</code></a>.</p>
<p>Module comparison</p>
<table>
<thead>
<tr>
<th>Client</th>
<th>Runtime dependencies</th>
<th><a href="https://github.com/AlDanial/cloc">Lines of code</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>amqp-client.js</td>
<td>0</td>
<td>1743</td>
</tr>
<tr>
<td>amqplib</td>
<td>14</td>
<td>6720 (w/o dependencies)</td>
</tr>
</tbody>
</table>
<h2 id="release" class="tsd-anchor-link">Release<a href="#release" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This project uses automated release scripts for version management.</p>
<h3 id="release-commands" class="tsd-anchor-link">Release Commands<a href="#release-commands" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The package.json includes several npm scripts for releasing:</p>
<ul>
<li><strong><code>npm run release</code></strong> - Performs a patch version bump (e.g., 3.2.1 → 3.2.2) and creates a release</li>
<li><strong><code>npm run release:minor</code></strong> - Performs a minor version bump (e.g., 3.2.1 → 3.3.0) and creates a release</li>
<li><strong><code>npm run release:major</code></strong> - Performs a major version bump (e.g., 3.2.1 → 4.0.0) and creates a release</li>
</ul>
<h3 id="what-happens-during-a-release" class="tsd-anchor-link">What happens during a release<a href="#what-happens-during-a-release" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li><strong>Tests</strong>: All tests are run to ensure everything passes (<code>preversion</code>)</li>
<li><strong>Version bump</strong>: npm automatically updates the version in <code>package.json</code></li>
<li><strong>File updates</strong>: The version is updated in <code>src/amqp-base-client.ts</code>, code is formatted, and changelog is updated (<code>version</code>)</li>
<li><strong>Staging</strong>: All changes are staged for commit (<code>version</code>)</li>
<li><strong>Git commit</strong>: npm automatically commits all staged changes with a version message</li>
<li><strong>Git tag</strong>: An annotated tag is created with the full changelog content as the tag message (<code>postversion</code>)</li>
<li><strong>Push</strong>: Both the commit and tags are pushed to the remote repository (<code>postversion</code>)</li>
<li><strong>CI deployment</strong>: The GitHub Actions workflow automatically publishes the new version to npm</li>
</ol>
<blockquote>
<p><strong>Technical Note</strong>: This release process leverages npm's built-in version lifecycle hooks (<code>preversion</code>, <code>version</code>, <code>postversion</code>). The <code>npm version</code> command automatically handles the git commit after running our custom <code>version</code> script, which is why we stage changes with <code>git add -A</code> rather than committing manually.</p>
</blockquote>
<h3 id="prerequisites" class="tsd-anchor-link">Prerequisites<a href="#prerequisites" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Before releasing:</p>
<ol>
<li>Add your changes to the <code>## [Unreleased]</code> section in <code>CHANGELOG.md</code></li>
<li>All tests should pass (<code>npm test</code>)</li>
<li>The working directory should be clean (no uncommitted changes)</li>
</ol>
<h3 id="automated-npm-publishing" class="tsd-anchor-link">Automated npm Publishing<a href="#automated-npm-publishing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When a new tag is pushed (e.g., <code>v3.3.0</code>), the GitHub Actions workflow (<code>.github/workflows/release.yml</code>) automatically:</p>
<ul>
<li>Builds the project</li>
<li>Publishes the package to npm with public access and provenance</li>
<li>Creates a GitHub release with browser bundle artifacts</li>
</ul>
<p>The git tag contains the complete changelog section for that version, including version header, all changes, and PR links. This makes it easy to see what changed in each release directly from the git tag.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#amqp-clientjs"><span>amqp-<wbr/>client.js</span></a><ul><li><a href="#support"><span>Support</span></a></li><li><a href="#install"><span>Install</span></a></li><li><a href="#example-usage"><span>Example usage</span></a></li><li><a href="#websockets"><span>Web<wbr/>Sockets</span></a></li><li><a href="#performance"><span>Performance</span></a></li><li><a href="#release"><span>Release</span></a></li><li><ul><li><a href="#release-commands"><span>Release <wbr/>Commands</span></a></li><li><a href="#what-happens-during-a-release"><span>What happens during a release</span></a></li><li><a href="#prerequisites"><span>Prerequisites</span></a></li><li><a href="#automated-npm-publishing"><span>Automated npm <wbr/>Publishing</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">@cloudamqp/amqp-client</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
